<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/style.css">
    <title>Index</title>
</head>

<body>
    <header class="cabeçalho">
        <div class="loginECadastro">
            <u><span style="margin-right: 40px;" onclick="funcLogin()" class="seta">Acesso corretor</span></u>
        </div>
    </header>
    <div class="conteudo conteudo1"
        style="background-image: url(assets/fundo_cads2.jpg); background-repeat: no-repeat; background-size: cover;">

        <div class="card esquerda">
            <p class="texto_card"> <span style="font-size: 40px;"> Origem dos seguros: </span> <br> <br>
                Os seguros foram criados antes da época das Grandes Navegações, surgindo como um acordo informal entre
                os cameleiros, que devido à alta taxa de camelos que morriam durante as travessias dos desertos
                orientais, eles se propunham a dividir entre os participantes da travessia o valor do animal morto e
                pagá-lo ao seu dono.
                <br> Com o avanço das grandes navegações, essa prática se expandiu de maneira similar com as grandes
                embarcações, criando em 1347, em Gênova, a primeira apólice formal de seguro, que justamente criava um
                acordo de proteção à embarcação italiana.
            </p>
        </div>

        <div class="card meio">
            <p class="texto_card"> <span style="font-size: 40px;"> Seguros na atualidade: </span> <br> <br>
                Atualmente, os seguros são de extrema importância, pois são responsáveis por oferecerem proteção
                financeira e tranquilidade, protegendo contra riscos inesperados e garantindo a estabilidade financeira
                em situações de emergência. <br>
                Prova de sua importância, é que no Brasil existem seguros obrigatórios, como, por exemplo, o DPVAT que
                visa garantir indenizações a vítimas de acidentes de trânsito ou o Seguro de Responsabilidade Civil para
                Obras Exigido em muitos contratos públicos e privados para autorizar a execução de obras, cobrindo danos
                materiais ou corporais a terceiros durante a construção.
            </p>
        </div>

        <div class="card direita">
            <p class="texto_card"> <span style="font-size: 40px;">Principais seguros da atualidade:</span> <br> <br>
                Atualmente, os seguros mais contratados são os de <span style="color: blue;">automóvel</span> e os de
                <span style="color: red;"> saúde </span>. O de automóvel <span style="color: blue;">cobre roubo,
                    colisões e danos a terceiros</span>, sendo altamente personalizado: seu valor varia conforme o
                modelo do carro, perfil do condutor. Já o de saúde, que
                <span style="color: red;"> protege o seu bem mais valioso — A VIDA —</span>, tem seu custo definido
                principalmente pela idade do contratante. Esses dois tipos de seguros mostram como o setor evoluiu,
                unindo proteção sob medida com acessibilidade para diferentes perfis.
        </div>


    </div>
    </div>


    </div>

    <div class="conteudo conteudo2"
        style="background-image: url(assets/fund_cotacao.jpg); background-repeat: no-repeat; background-size: cover;">
        <h1 class="titulo_cotacao" style="color: white; margin-top: 1%; font-size: 60px;">Solicite uma cotação</h1>

        <div class="card dados" style="justify-self: center;">

            <input class="input" type="text" placeholder="Nome de contato" id="ipt_nome"> <br>
            <input class="input" type="number" placeholder="Numero para contato" id="ipt_celular"> <br>
            <input class="input" type="text" placeholder="E-mail para contato" id="ipt_email"> <br>
            <input class="input" type="text" placeholder="Mensagem da solicitação" id="ipt_mensage"> <br>
            <input class="input" type="number" placeholder="Idade" id="ipt_idade"> <br>
            <button class="input seta" onclick="enviarCotacao()">Solicitar cotação</button>
        </div>


        <div class="linhaLogo" id="linhaLogo"> Simulação de preços em planos indicados da Porto Seguro (minimo de 3
            vidas por contrato) <img src="assets/porto-saude.svg" height="60px"></div>
        <div class="card1" id="pai1"></div>
        <div class="card2" id="pai2"></div>
        <div class="card3" id="pai3"></div>
        <div class="alerta" id="paiAlerta"></div>




    </div>

    <div class="footer">
        <div class="container">
            <h4>Feito com amor por aluno &hearts; SPTech &copy; 2025</h4>
            <span class="version">v1.0.0</span>
            <i>
                <h3 style="color: rgb(195, 19, 19);"> Preços sujeitos a alterações, espere o retorno da solicitação para
                    mais informações</h3>
            </i>
        </div>
    </div>


</body>

</html>


<script>
    var preco1 = ''
    var preco2 = ''
    var preco3 = ''
    function funcLogin() {
        window.location.href = "login.html"
    }

    function enviarCotacao() {
        var nome = ipt_nome.value;
        var celular = ipt_celular.value;
        var email = ipt_email.value;
        var mensagem = ipt_mensage.value;
        var idade = ipt_idade.value;



        if (nome == "" || celular == "" || email == "" || mensagem == "" || idade == "") {
            alert("Preencha todos os campos!");
            return;
        }
    if(email.includes('@' && '.')){
    }else {
    alert("Seu email deve conter @ e .");
      return false;
    }

        // Validação de idade e preço

        if (idade <= 18) {
            preco1 = 'R$ 342,57';
        } else if (idade <= 23) {
            preco1 = 'R$ 436,22';
        } else if (idade <= 28) {
            preco1 = 'R$ 526,22';
        } else if (idade <= 33) {
            preco1 = 'R$ 602,44';
        } else if (idade <= 38) {
            preco1 = 'R$ 652,74';
        } else if (idade <= 43) {
            preco1 = 'R$ 674,12';
        } else if (idade <= 48) {
            preco1 = 'R$ 792,57';
        } else if (idade <= 53) {
            preco1 = 'R$ 866,88';
        } else if (idade <= 58) {
            preco1 = 'R$ 1.071,10';
        } else {
            preco1 = 'R$ 1.800,43';
        }


        pai2.innerHTML = `<div class="card dados card1" id="card1">
            <b><h1 style="color:#ffd700;">OURO PRO</h1></b> <br>
            <section class="dadosPlanos">
                <h2>Hospital referencia: <span style="color: whitesmoke;"> Oswaldo Cruz </span> <br>
                    </section> <br>
                    <section class="dadosPlanos">
                        <h2>Preço individual na idade de ${idade} anos: <br> <span style="color: whitesmoke;">R$ ${preco1}</h2>
            </section>
    </div>`

        if (idade <= 18) {
            preco2 = 'R$ 726,59';
        } else if (idade <= 23) {
            preco2 = 'R$ 925,20';
        } else if (idade <= 28) {
            preco2 = 'R$ 1.116,10';
        } else if (idade <= 33) {
            preco2 = 'R$ 1.277,74';
        } else if (idade <= 38) {
            preco2 = 'R$ 1.384,45';
        } else if (idade <= 43) {
            preco2 = 'R$ 1.429,78';
        } else if (idade <= 48) {
            preco2 = 'R$ 1.681,01';
        } else if (idade <= 53) {
            preco2 = 'R$ 1.838,63';
        } else if (idade <= 58) {
            preco2 = 'R$ 2.271,76';
        } else {
            preco2 = 'R$ 3.818,65';
        }

        pai1.innerHTML = `<div class="card dados card1" id="card1">
    <b><h1 style="color:#ffbf00;">OURO MAX</h1></b> <br>
    <section class="dadosPlanos">
           <h2>Hospital referencia: <span style="color: whitesmoke;"> Sírio-Libanês </span> <br>
            </section> <br>
            <section class="dadosPlanos">
                <h2>Preço individual na idade de ${idade} anos: <br> <span style="color: whitesmoke;">R$ ${preco2}</h2>
                    </section>
                    </div>`


        if (idade <= 18) {
            preco3 = 'R$ 296,20';
        } else if (idade <= 23) {
            preco3 = 'R$ 377,16';
        } else if (idade <= 28) {
            preco3 = 'R$ 454,99';
        } else if (idade <= 33) {
            preco3 = 'R$ 520,88';
        } else if (idade <= 38) {
            preco3 = 'R$ 564,38';
        } else if (idade <= 43) {
            preco3 = 'R$ 582,86';
        } else if (idade <= 48) {
            preco3 = 'R$ 685,27';
        } else if (idade <= 53) {
            preco3 = 'R$ 749,53';
        } else if (idade <= 58) {
            preco3 = 'R$ 926,10';
        } else if (idade <= 70) {
            preco3 = 'R$ 1.556,69';
        } else{
            preco3 = 'R$ 1.556,69';
            alert (`Devido a idade digitada ser superior a 70 ano, seu plano está sujeito a condições especiais para a aceitação
            Aguarde o contato para mais informações`)
        }

        pai3.innerHTML = `<div class="card dados card1" id="card1">
    <b><h1 style="color:#c8c8c8;">PRATA PRO</h1></b> <br>
    <section class="dadosPlanos">
        <h2>Hospital referencia: <span style="color: whitesmoke;"> Santa Catarina </span> <br>
            </section> <br>
            <section class="dadosPlanos">
                <h2>Preço individual na idade de ${idade} anos: <br> <span style="color: whitesmoke;">R$ ${preco3}</h2>
                    </section>
                    </div>`

        linhaLogo.innerHTML = `
                    Simulação de preços em planos indicados da Porto Seguro <img src="assets/porto-saude.svg" height="60px">`


        
         // Fetch para pegar o total de usuarios
                    console.log('Pré fetch buscar usuarios');
                    
        fetch(`/leads/verQuantidade`, { cache: 'no-store' })
            .then(function (response) {
                if (response.ok) {
                    response.json().then(function (resposta) {
                        console.log(resposta)
                        var quantidade_usuarios = resposta.map(item => item.numUsuarios);


                        console.log('passou do fetch de agregar usuario', quantidade_usuarios);

                        var conta = Math.random() * (quantidade_usuarios - 1) + 1
                        var receber = conta.toFixed(0)
                        console.log('usuario recebendo', receber)
                        enviarLead(nome,celular,email,mensagem,idade,receber)
                    });
                }
            });
        
        }


        function enviarLead(nome,celular,email,mensagem,idade,receber){    
        //Fetch para enviar o lead
        fetch("/leads/cadastrar", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
            },
            body: JSON.stringify({
                // crie um atributo que recebe o valor recuperado aqui
                // Agora vá para o arquivo routes/leads.js
                nomeServer: nome,
                celularServer: celular,
                emailServer: email,
                mensagemServer: mensagem,
                idadeServer: idade,
                receberServer: receber,
                
            }),
        })
            .then(response => {
                if (response.ok) {
                    alert("Cotação enviada com sucesso!");
                } else {
                    response.text().then(texto => {
                        alert("Erro ao enviar cotação: " + texto);
                    });
                }
            })
            .catch(error => {
                alert("Erro de conexão com o servidor!");
                console.error(error);
            });




    }
</script>


